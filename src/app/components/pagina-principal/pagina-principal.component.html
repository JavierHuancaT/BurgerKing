<!-- Título de combos -->
<section class="combos-header">
  <h2>Combos</h2>
</section>

<!-- Grid de productos (combos) -->
<div class="combos-container">
  <div class="combos-grid">
    <ng-container *ngIf="(combos$ | async) as combos; else empty">
      <div class="combo-wrapper" *ngFor="let combo of combos; trackBy: trackById" (click)="selectCombo(combo.id)">
        <div class="combo-card">

          <!-- Badge de promo -->
          <div class="promo-badge" *ngIf="combo.descuento > 0">-{{ combo.descuento }}%</div>

          <!-- Imagen -->
          <img
            [src]="combo.imageData || 'assets/placeholder-product.png'"
            [alt]="'Imagen de ' + combo.name"
            class="combo-img"
          />

          <h5>{{ combo.name }}</h5>

          <!-- Descripción -->
          <p class="combo-description" *ngIf="combo.descripcion">{{ combo.descripcion }}</p>

          <!-- Precio con promo -->
          <p class="combo-price">
            <span *ngIf="combo.descuento > 0" class="tachado">
              {{ combo.basePrice | currency:'CLP':'symbol':'1.0-0' }}
            </span>
            <strong>
              {{ combo.precioOferta | currency:'CLP':'symbol':'1.0-0' }}
            </strong>
          </p>

        </div>
        <div class="combo-actions" *ngIf="selectedComboId === combo.id" (click)="$event.stopPropagation()">
            <ng-container *ngIf="combo.personalizaciones && combo.personalizaciones.length > 0">
                <button class="btn-personalizar" (click)="personalize(combo)">Personalizar</button>
            </ng-container>
            <button class="btn-add-to-cart" (click)="addToCart(combo)">Agregar al carrito</button>
        </div>
      </div>
    </ng-container>

    <ng-template #empty>
      <div class="text-muted" style="padding:1rem;">
        Aún no hay productos. Agrega desde el panel de <strong>Administrador → Productos</strong>.
      </div>
    </ng-template>
  </div>
</div>
